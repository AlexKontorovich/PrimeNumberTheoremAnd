import Architect
import Mathlib.Tactic


blueprint_comment /--
\section{Numerical content of BKLNW Appendix A}

Purely numerical calculations from Appendix A of \cite{BKLNW}.  This is kept in a separate file from the main file to avoid heavy recompilations.  Because of this, this file should not import any other files from the PNT+ project, other than further numerical data files.

-/
namespace BKLNW_app

def table_8 : List (ℝ × ℝ) := [
  (20, 4.2676e-5),
  (21, 2.5885e-5),
  (22, 1.5701e-5),
  (23, 9.5224e-6),
  (24, 5.7757e-6),
  (25, 3.5032e-6),
  (26, 2.1248e-6),
  (27, 1.2888e-6),
  (28, 7.8165e-7),
  (29, 4.7410e-7),
  (30, 2.8756e-7),
  (31, 1.7442e-7),
  (32, 1.0579e-7),
  (33, 6.4162e-8),
  (34, 3.8917e-8),
  (35, 2.3604e-8),
  (36, 1.9339e-8),
  (37, 1.9339e-8),
  (38, 1.9339e-8),
  (39, 1.9339e-8),
  (40, 1.9339e-8),
  (41, 1.9339e-8),
  (42, 1.9338e-8),
  (43, 1.9339e-8),
  (44, 1.7201e-8),
  (45, 1.0908e-8),
  (46, 6.9452e-9),
  (47, 4.4013e-9),
  (48, 2.7915e-9),
  (49, 1.7690e-9),
  (50, 1.1200e-9),
  (51, 7.0925e-10),
  (52, 4.4782e-10),
  (53, 2.8281e-10),
  (54, 1.7847e-10),
  (55, 1.1256e-10),
  (56, 7.0929e-11),
  (57, 4.4656e-11),
  (58, 2.8329e-11),
  (59, 1.8441e-11),
  (60, 1.2216e-11),
  (65, 3.5713e-12),
  (70, 2.7924e-12),
  (75, 2.7037e-12),
  (80, 2.6109e-12),
  (85, 2.5693e-12),
  (90, 2.5214e-12),
  (95, 2.4920e-12),
  (100, 2.4531e-12),
  (200, 2.1816e-12),
  (300, 2.0903e-12),
  (400, 2.0399e-12),
  (500, 1.9999e-12),
  (600, 1.9890e-12),
  (700, 1.9765e-12),
  (800, 1.9672e-12),
  (900, 1.9600e-12),
  (1000, 1.9476e-12),
  (1500, 1.9369e-12),
  (1600, 1.9293e-12),
  (1700, 1.9274e-12),
  (1725, 1.9270e-12),
  (1750, 1.9266e-12),
  (1775, 1.9261e-12),
  (1800, 1.9257e-12),
  (1825, 1.9254e-12),
  (1850, 1.9250e-12),
  (1875, 1.9246e-12),
  (1900, 1.9242e-12),
  (1925, 1.9239e-12),
  (1950, 1.9235e-12),
  (1975, 1.9232e-12),
  (2000, 1.9229e-12),
  (2025, 1.9225e-12),
  (2050, 1.9222e-12),
  (2075, 1.9219e-12),
  (2100, 1.9217e-12),
  (2125, 1.9214e-12),
  (2150, 1.9211e-12),
  (2175, 1.9208e-12),
  (2200, 1.9206e-12),
  (2225, 1.9203e-12),
  (2250, 1.9200e-12),
  (2275, 1.9198e-12),
  (2300, 1.9195e-12),
  (2325, 1.8751e-12),
  (2350, 1.7788e-12),
  (2375, 1.6875e-12),
  (2400, 1.6009e-12),
  (2425, 1.4218e-12),
  (2450, 1.2214e-12),
  (2475, 1.0512e-12),
  (2500, 9.0631e-13),
  (2525, 7.7933e-13),
  (2550, 6.7069e-13),
  (2575, 5.7662e-13),
  (2600, 4.9610e-13),
  (2625, 4.2694e-13),
  (2650, 3.6747e-13),
  (2675, 3.1642e-13),
  (2700, 2.7243e-13),
  (2725, 2.3455e-13),
  (2750, 2.0207e-13),
  (2775, 1.7404e-13),
  (2800, 1.5006e-13),
  (2825, 1.2952e-13),
  (2850, 1.1190e-13),
  (2875, 9.6389e-14),
  (2900, 8.3167e-14),
  (2925, 7.1662e-14),
  (2950, 6.1818e-14),
  (2975, 5.3383e-14),
  (3000, 4.5998e-14),
  (3025, 3.9721e-14),
  (3050, 3.4247e-14),
  (3075, 2.9576e-14),
  (3100, 2.5535e-14),
  (3125, 2.2031e-14),
  (3150, 1.9028e-14),
  (3175, 1.6430e-14),
  (3200, 1.4197e-14),
  (3225, 1.2278e-14),
  (3250, 1.0627e-14),
  (3275, 9.1915e-15),
  (3300, 7.9435e-15),
  (3325, 6.8702e-15),
  (3350, 5.9387e-15),
  (3375, 5.1333e-15),
  (3400, 4.4414e-15),
  (3425, 3.8454e-15),
  (3450, 3.3251e-15),
  (3475, 2.8741e-15),
  (3500, 2.4865e-15),
  (3525, 2.1523e-15),
  (3550, 1.8633e-15),
  (3575, 1.6124e-15),
  (3600, 1.3966e-15),
  (3625, 1.2101e-15),
  (3650, 1.0470e-15),
  (3675, 9.0704e-16),
  (3700, 7.8647e-16),
  (3725, 6.8213e-16),
  (3750, 5.9196e-16),
  (3775, 5.1352e-16),
  (3800, 4.4496e-16),
  (3825, 3.8583e-16),
  (3850, 3.3477e-16),
  (3875, 2.9011e-16),
  (3900, 2.5173e-16),
  (3925, 2.1855e-16),
  (3950, 1.8982e-16),
  (3975, 1.6448e-16),
  (4000, 1.4264e-16),
  (4025, 1.2412e-16),
  (4050, 1.0750e-16),
  (4075, 9.3378e-17),
  (4100, 8.1038e-17),
  (4125, 7.0376e-17),
  (4150, 6.1237e-17),
  (4175, 5.3118e-17),
  (4200, 4.6145e-17),
  (4225, 4.0111e-17),
  (4250, 3.4884e-17),
  (4275, 3.0318e-17),
  (4300, 2.6350e-17),
  (4325, 2.2914e-17),
  (4350, 1.9935e-17),
  (4375, 1.7336e-17),
  (4400, 1.5084e-17),
  (4425, 1.3153e-17),
  (4450, 1.1437e-17),
  (4475, 9.9627e-18),
  (4500, 8.6830e-18),
  (4525, 7.5706e-18),
  (4550, 6.5914e-18),
  (4575, 5.7400e-18),
  (4600, 5.0071e-18),
  (4625, 4.3570e-18),
  (4650, 3.7976e-18),
  (4675, 3.3113e-18),
  (4700, 2.8885e-18),
  (4725, 2.5214e-18),
  (4750, 2.1972e-18),
  (4775, 1.9146e-18),
  (4800, 1.6693e-18),
  (4825, 1.4561e-18),
  (4850, 1.2709e-18),
  (4875, 1.1095e-18),
  (4900, 9.6895e-19),
  (4925, 8.4602e-19),
  (4950, 7.3831e-19),
  (4975, 6.4458e-19),
  (5000, 5.6304e-19),
  (5100, 3.2860e-19),
  (5200, 1.9218e-19),
  (5300, 1.1293e-19),
  (5400, 6.6313e-20),
  (5500, 3.9136e-20),
  (5600, 2.3189e-20),
  (5700, 1.3808e-20),
  (5800, 8.2235e-21),
  (5900, 4.9138e-21),
  (6000, 2.9430e-21),
  (6100, 1.7722e-21),
  (6200, 1.0664e-21),
  (6300, 6.4481e-22),
  (6400, 3.9202e-22),
  (6500, 2.3850e-22),
  (6600, 1.4521e-22),
  (6700, 8.8894e-23),
  (6800, 5.4568e-23),
  (6900, 3.3650e-23),
  (7000, 2.0766e-23),
  (7100, 1.2893e-23),
  (7200, 8.0276e-24),
  (7300, 5.0020e-24),
  (7400, 3.1319e-24),
  (7500, 1.9616e-24),
  (7600, 1.2315e-24),
  (7700, 7.7664e-25),
  (7800, 4.9129e-25),
  (7900, 3.1161e-25),
  (8000, 1.9762e-25),
  (8100, 1.2594e-25),
  (8200, 8.0517e-26),
  (8300, 5.1497e-26),
  (8400, 3.3065e-26),
  (8500, 2.1298e-26),
  (8600, 1.3772e-26),
  (8700, 8.8888e-27),
  (8800, 5.7961e-27),
  (8900, 3.7648e-27),
  (9000, 2.4454e-27),
  (9100, 1.5915e-27),
  (9200, 1.0407e-27),
  (9300, 6.8293e-28),
  (9400, 4.5234e-28),
  (9500, 2.9701e-28),
  (9600, 1.9649e-28),
  (9700, 1.2949e-28),
  (9800, 8.5698e-29),
  (9900, 5.7396e-29),
  (10000, 3.7850e-29),
  (10100, 2.5241e-29),
  (10200, 1.6883e-29),
  (10300, 1.1283e-29),
  (10400, 7.5768e-30),
  (10500, 5.1016e-30),
  (10600, 3.4435e-30),
  (10700, 2.3288e-30),
  (10800, 1.5782e-30),
  (10900, 1.0582e-30),
  (11000, 7.1427e-31),
  (11100, 4.8354e-31),
  (11200, 3.2850e-31),
  (11300, 2.2377e-31),
  (11400, 1.5279e-31),
  (11500, 1.0434e-31),
  (11600, 7.1321e-32),
  (11700, 4.8892e-32),
  (11800, 3.3603e-32),
  (11900, 2.3147e-32),
  (12000, 1.5976e-32),
  (12100, 1.1048e-32),
  (12200, 7.5730e-33),
  (12300, 5.2476e-33),
  (12400, 3.6432e-33),
  (12500, 2.5337e-33),
  (12600, 1.7565e-33),
  (12700, 1.2188e-33),
  (12800, 8.4803e-34),
  (12900, 5.9154e-34),
  (13000, 4.1356e-34),
  (14000, 1.2266e-35),
  (15000, 4.1071e-37),
  (16000, 1.5141e-38),
  (17000, 6.2041e-40),
  (18000, 2.8284e-41),
  (19000, 1.3679e-42),
  (20000, 7.1622e-44),
  (21000, 4.1185e-45),
  (22000, 2.4393e-46),
  (23000, 1.5648e-47),
  (24000, 1.0703e-48),
  (25000, 7.5725e-50)
]

noncomputable def table_8_ε (b : ℝ) : ℝ := sInf { ε | ∃ p ∈ table_8, p.1 ≤ b ∧ p.2 = ε }

/-- To avoid roundoff errors we add a safety margin here -/
abbrev table_8_margin : ℝ := 1.001

/- 20 4.26760 · 10−5
21 2.58843 · 10−5
22 1.56996 · 10−5
23 9.52229 · 10−6
24 5.77556 · 10−6
25 3.50306 · 10−6
30 2.87549 · 10−7
35 2.36034 · 10−8
40 1.93378 · 10−8
45 1.09073 · 10−8
50 1.11990 · 10−9
100 2.45299 · 10−12
200 2.18154 · 10−12
300 2.09022 · 10−12
400 2.03981 · 10−12
500 1.99986 · 10−12
600 1.98894 · 10−12
700 1.97643 · 10−12
800 1.96710 · 10−12
900 1.95987 · 10−12
1000 1.94751 · 10−12
1500 1.93677 · 10−12
2000 1.92279 · 10−12
b, b′
ε(b, b′
)
Computed as in Theorem 13
2500 9.06304 · 10−13
3000 4.59972 · 10−14
3500 2.48641 · 10−15
4000 1.42633 · 10−16
4500 8.68295 · 10−18
5000 5.63030 · 10−19
5500 3.91348 · 10−20
6000 2.94288 · 10−21
6500 2.38493 · 10−22
7000 2.07655 · 10−23
7500 1.96150 · 10−24
8000 1.97611 · 10−25
8500 2.12970 · 10−26
9000 2.44532 · 10−27
9500 2.97001 · 10−28
10000 3.78493 · 10−29
10500 5.10153 · 10−30
11000 7.14264 · 10−31
11500 1.04329 · 10−31
12000 1.59755 · 10−32
12500 2.53362 · 10−33
13000 4.13554 · 10−34
13500 7.21538 · 10−35
b, b′
ε(b, b′
)
Computed as in Theorem 13
14000 1.22655 · 10−35
15000 4.10696 · 10−37
16000 1.51402 · 10−38
17000 6.20397 · 10−40
18000 2.82833 · 10−41
19000 1.36785 · 10−42
20000 7.16209 · 10−44
21000 4.11842 · 10−45
22000 2.43916 · 10−46
23000 1.56474 · 10−47
24000 1.07022 · 10−48
25000 7.57240 · 10−50
-/

/-- Simplified form of table -/
noncomputable def table_8_ε' (b : ℝ) : ℝ :=
  if b < 20 then 1   -- junk value
  else if b < 21 then 4.26760e-5 * table_8_margin
  else if b < 22 then 2.58843e-5 * table_8_margin
  else if b < 23 then 1.56996e-5 * table_8_margin
  else if b < 24 then 9.52229e-6 * table_8_margin
  else if b < 25 then 5.77556e-6 * table_8_margin
  else if b < 30 then 3.50306e-6 * table_8_margin
  else if b < 35 then 2.87549e-7 * table_8_margin
  else if b < 40 then 2.36034e-8 * table_8_margin
  else if b < 45 then 1.93378e-8 * table_8_margin
  else if b < 50 then 1.09073e-8 * table_8_margin
  else if b < 100 then 1.11990e-9 * table_8_margin
  else if b < 200 then 2.45299e-12 * table_8_margin
  else if b < 300 then 2.18154e-12 * table_8_margin
  else if b < 400 then 2.09022e-12 * table_8_margin
  else if b < 500 then 2.03981e-12 * table_8_margin
  else if b < 600 then 1.99986e-12 * table_8_margin
  else if b < 700 then 1.98894e-12 * table_8_margin
  else if b < 800 then 1.97643e-12 * table_8_margin
  else if b < 900 then 1.96710e-12 * table_8_margin
  else if b < 1000 then 1.95987e-12 * table_8_margin
  else if b < 1500 then 1.94751e-12 * table_8_margin
  else if b < 2000 then 1.93677e-12 * table_8_margin
  else if b < 2500 then 1.92279e-12 * table_8_margin
  else if b < 3000 then 9.06304e-13 * table_8_margin
  else if b < 3500 then 4.59972e-14 * table_8_margin
  else if b < 4000 then 2.48641e-15 * table_8_margin
  else if b < 4500 then 1.42633e-16 * table_8_margin
  else if b < 5000 then 8.68295e-18 * table_8_margin
  else if b < 5500 then 5.63030e-19 * table_8_margin
  else if b < 6000 then 3.91348e-20 * table_8_margin
  else if b < 6500 then 2.94288e-21 * table_8_margin
  else if b < 7000 then 2.38493e-22 * table_8_margin
  else if b < 7500 then 2.07655e-23 * table_8_margin
  else if b < 8000 then 1.96150e-24 * table_8_margin
  else if b < 8500 then 1.97611e-25 * table_8_margin
  else if b < 9000 then 2.12970e-26 * table_8_margin
  else if b < 9500 then 2.44532e-27 * table_8_margin
  else if b < 10000 then 2.97001e-28 * table_8_margin
  else if b < 10500 then 3.78493e-30 * table_8_margin
  else if b < 11000 then 5.10153e-31 * table_8_margin
  else if b < 11500 then 7.14264e-32 * table_8_margin
  else if b < 12000 then 1.04329e-32 * table_8_margin
  else if b < 12500 then 1.59755e-33 * table_8_margin
  else if b < 13000 then 2.53362e-34 * table_8_margin
  else if b < 13500 then 4.13554e-35 * table_8_margin
  else if b < 14000 then 7.21538e-36 * table_8_margin
  else if b < 15000 then 1.22655e-37 * table_8_margin
  else if b < 16000 then 4.10696e-39 * table_8_margin
  else if b < 17000 then 1.51402e-40 * table_8_margin
  else if b < 18000 then 6.20397e-42 * table_8_margin
  else if b < 19000 then 2.82833e-43 * table_8_margin
  else if b < 20000 then 1.36785e-44 * table_8_margin
  else if b < 21000 then 7.16209e-46 * table_8_margin
  else if b < 22000 then 4.11842e-47 * table_8_margin
  else if b < 23000 then 2.43916e-48 * table_8_margin
  else if b < 24000 then 1.56474e-49 * table_8_margin
  else if b < 25000 then 1.07022e-50 * table_8_margin
  else 7.57240e-52 * table_8_margin


@[blueprint
  "bklnw-table-8-compat"
  (title := "BKLNW Table 8 vs expanded Table 8")
  (statement := /-- The value of $\eps(b)$ arising from Table 8 of \cite{BKLNW} is weaker than that from the expanded version of Table 8 available in the arXiv.-/)
  (proof := /-- Routine computation. -/)
  (latexEnv := "sublemma")
  (discussion := 807)]
theorem table_8_ε.le_simp (b : ℝ) (hb : b ≥ 20) : table_8_ε b ≤ table_8_ε' b := by
  sorry

end BKLNW_app
